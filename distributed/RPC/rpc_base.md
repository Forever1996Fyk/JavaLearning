## <center>RPC 基础知识</center>

### 1. 什么是RPC? 

**RPC(Remote Procedure Call) 远程过程调用**: 一种通过网络从远程计算机程序上请求服务, 而不需要了解底层网络技术的协议。RPC的出现就是为了调用远程方法像调用本地方法一样简单。

### 2. RPC的原理是什么?

#### 2.1 远程调用服务的过程

(1) 服务消费者(client)以本地调用方式调用服务;

(2) 客户端存根(client stub) 接收到调用后负责将方法, 参数等组装成能够进行网络传输的消息体;

(3) client stud 找到服务地址, 并将消息发送到服务端;

(4) 服务端存根(server stud) 收到消息后进行解码;

(5) server stud 根据解码结构调用本地的服务;

(6) 本地服务执行并将结果返回给server stud;

(7) server stud将返回结果打包成消息并发送至消费者;

(8) client stud 接收到消息, 并进行解码;

(9) 服务消费者得到最终结果。

**RPC的目的就是把2-8这些步骤都封装起来, 让用户忽略这些细节。**

#### 2.2 Java如何透明化远程服务调用?

对于Java来说就是使用代理! Java代理方式有两种: jdk动态代理; 字节码生成。

虽然字节码实现的代理更为强大和高效, 但是代码维护不易, 所以大部分都是选择动态代理的方式。

#### 2.3 如何对消息进行编码和解码?

> 发送消息数据结构

1. 接口名称:

如果不传, 服务端就不知道调用哪个接口了;

2. 方法名:

一个接口内可能有很多方法, 如果不传方法名服务端就不知道调用哪个方法;

3. 参数类型&参数值:

参数类型有很多, 例如: boolean, int, long, double, string, map, list 以及相应的参数值;

4. 超时时间

5. requestID:

请求id唯一标识。

> 序列化


